<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Sobel operator</title>
    <link rel="stylesheet" href="media/bootstrap.min.css" />
    <link rel="stylesheet" href="media/base.css" />
    <script src="media/sobel.js"></script>
    <script>
      function demo() {
        /* kernel selector */
        var kernel_setting = window.location.search.substring(1).split("&");
        kernel_setting = (kernel_setting.length > 1) ? parseInt(kernel_setting[1].split('k=')[1]): 0;

        /* image selector */
        var images = [
          "7AM5JEn",
          "dwrtxlP",
          "lCoYP4z",
          "w8dK7fg",
          "rmjWVSN",
          ];
        var imgsel = document.getElementById('image-selector');
        for (var i=0; i < images.length; i++) {
          var atag = document.createElement("a");
          atag.setAttribute("href", "demo.html?img=" + i + "&k=" + kernel_setting);
          var imgtag = document.createElement("img");
          imgtag.setAttribute("src", "images/" + images[i] + "_t.jpg");
          imgtag.setAttribute("width", "96px");
          imgtag.setAttribute("height", "96px");
          atag.appendChild(imgtag)
          imgsel.appendChild(atag);
        }

        /* calculation */
        var img_id = parseInt(window.location.search.substring(1).split("&")[0].split('img=')[1]) || 0;
        if ((images.length - 1) < img_id) {
          img_id = 0;
        }

        var kernel;
        if (kernel_setting == 0) {
          kernel = [
              [ 1, 0,-1],
              [ 2, 0,-2],
              [ 1, 0,-1],
          ];
        } else if (kernel_setting == 1) {
          kernel = [
              [ 1, 2, 1],
              [ 0, 0, 0],
              [-1,-2,-1],
          ];
        } else {
          kernel = [
              [ 1, 1, 0],
              [ 1, 0,-1],
              [ 0,-1,-1],
          ];
        }
        var image = document.getElementById('image');
        image.crossOrigin = "anonymous";
        image.src = "http://i.imgur.com/" + images[img_id] + ".jpg";
        image.onload = function() {
          var sobel = new Sobel({
            element: "image",
            kernel: kernel,
            size: 400,
          });
          sobel.calc();
        };
      }
    </script>
  </head>
  <body onload="demo();">
    <div class="container">
      <h1>Sobel operator demo</h1>
      <div id="description">
        <p>
          Sobel operator.
        </p>
      </div>
      <div id="image-selector"></div>
      <div id="image-result">
        <img id="image" />
      </div>
    </div>
  </body>
</html>
